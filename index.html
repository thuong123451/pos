<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hóa Đơn Bán Hàng</title>
  <style>
    .items-table { width: 100%; border-collapse: collapse; }
    .items-table th, .items-table td { border: 1px solid #000; padding: 8px; }
    .summary { margin-top: 8px; font-size: 1.2em; }
  </style>
</head>
<body>

  <h1>Hóa Đơn Bán Hàng</h1>

  <table class="items-table" id="products-tbody">
    <thead>
      <tr>
        <th>Sản Phẩm</th>
        <th>Số Lượng</th>
        <th>Đơn Giá</th>
        <th>Thành Tiền</th>
      </tr>
    </thead>
    <tbody>
      <!-- Các sản phẩm đã được thêm vào từ chi tiết đơn hàng -->
    </tbody>
  </table>

  <div class="summary">
    <p>Tổng Tiền: <span id="total">562,527 VND</span></p>
    <p>Giảm Giá: <span id="discount">0 VND</span></p>
    <p>Thuế VAT (10%): <span id="vat">56,253 VND</span></p>
    <p>Tổng Tiền Sau Thuế: <span id="total_after_vat">618,780 VND</span></p>
  </div>

  <script>
    window.onload = function () {
      // Lấy thông tin từ URL (hoặc từ dữ liệu được truyền từ AppSheet)
      const so_don_hang = new URLSearchParams(window.location.search).get('so_don_hang');
      const so_ban = new URLSearchParams(window.location.search).get('So_ban');
      const ngay_dat = new URLSearchParams(window.location.search).get('ngay_dat');
      const thanh_tien = new URLSearchParams(window.location.search).get('thanh_tien');
      const giam_gia = new URLSearchParams(window.location.search).get('giam_gia');
      const tong_tien_sau_ck = new URLSearchParams(window.location.search).get('tong_tien_sau_ck');
      const tien_vat = new URLSearchParams(window.location.search).get('tien_vat');
      const tong_tien_sau_vat = new URLSearchParams(window.location.search).get('tong_tien_sau_vat');

      // Hiển thị thông tin đơn hàng
      document.getElementById('so-don-hang').textContent = so_don_hang;
      document.getElementById('so-ban').textContent = so_ban;
      document.getElementById('ngay-dat').textContent = ngay_dat;

      // Hiển thị giá trị tính sẵn
      document.getElementById('total').textContent = thanh_tien + " VND";
      document.getElementById('discount').textContent = giam_gia + " VND";
      document.getElementById('vat').textContent = tien_vat + " VND";
      document.getElementById('total_after_vat').textContent = tong_tien_sau_vat + " VND";

      // Cập nhật bảng sản phẩm (Giả sử đã có sản phẩm trong URL)
      const productsData = new URLSearchParams(window.location.search).get('products');
      const products = JSON.parse(decodeURIComponent(productsData));
      const tbody = document.getElementById('products-tbody');
      products.forEach(product => {
        tbody.innerHTML += `
          <tr>
            <td>${product.sanpham}</td>
            <td>${product.soluong}</td>
            <td>${product.dongia.toLocaleString()}</td>
            <td>${product.thanhtien.toLocaleString()}</td>
          </tr>
        `;
      });
    };
  </script>

</body>
</html>

